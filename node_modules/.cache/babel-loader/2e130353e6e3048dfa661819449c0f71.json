{"ast":null,"code":"var _jsxFileName = \"/Users/msumaran/Documents/Proyectos/masternativos/src/app/scrumboard/board/BoardCard.js\";\nimport _ from '@lodash';\nimport Avatar from '@material-ui/core/Avatar';\nimport Card from '@material-ui/core/Card';\nimport Icon from '@material-ui/core/Icon';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport clsx from 'clsx';\nimport moment from 'moment';\nimport React from 'react';\nimport { Draggable } from 'react-beautiful-dnd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport * as Actions from '../store/actions';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    card: {\n      color: '#fff',\n      transitionProperty: 'box-shadow',\n      transitionDuration: theme.transitions.duration.short,\n      transitionTimingFunction: theme.transitions.easing.easeInOut\n    }\n  };\n});\n\nfunction BoardCard(props) {\n  var _this = this;\n\n  var dispatch = useDispatch();\n  var board = useSelector(function (_ref) {\n    var scrumboardApp = _ref.scrumboardApp;\n    return scrumboardApp.board;\n  });\n  var classes = useStyles(props);\n  var card = props.card,\n      index = props.index,\n      list = props.list;\n  card.checklists = _.keyBy(card.checklists, 'id');\n  card.checklists = _.values(card.checklists);\n  if (!_.has(card, \"idLabels\")) card.idLabels = [];\n  if (!_.has(card, \"checklists\")) card.checklists = [];\n  if (!_.has(card, \"checkItems\")) card.checkItems = [];\n  if (!_.has(card, \"idMembers\")) card.idMembers = [];\n  if (!_.has(card, \"attachments\")) card.attachments = [];\n  if (!_.has(card, \"comments\")) card.comments = [];\n  if (!_.has(card, \"activities\")) card.activities = [];\n  card.checklists.map(function (list) {\n    if (list.checkItems === undefined) list.checkItems = [];\n    return null;\n  });\n  var checkItemsChecked = getCheckItemsChecked(card);\n  var checkItems = getCheckItems(card);\n  var commentsCount = getCommentsCount(card);\n\n  function handleCardClick(ev, _card, _list) {\n    ev.preventDefault();\n    var data = {\n      card: _card,\n      list: _list\n    };\n    dispatch(Actions.openCardDialog(data));\n  }\n\n  function getCheckItemsChecked(_card) {\n    if (!_.has(_card, \"checklists\")) return 0;else return _.sum(_card.checklists.map(function (list) {\n      return _.sum(list.checkItems.map(function (x) {\n        return x.checked ? 1 : 0;\n      }));\n    }));\n  }\n\n  function getCheckItems(_card) {\n    if (!_.has(_card, \"checklists\")) return 0;else return _.sum(_card.checklists.map(function (x) {\n      return x.checkItems.length;\n    }));\n  }\n\n  function getCommentsCount(_card) {\n    return _.sum(_card.activities.map(function (x) {\n      return x.type === 'comment' ? 1 : 0;\n    })); //return;\n  }\n\n  console.log('card: ', card);\n  return /*#__PURE__*/React.createElement(Draggable, {\n    draggableId: card.id,\n    index: index,\n    type: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 3\n    }\n  }, function (provided, snapshot) {\n    return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n      ref: provided.innerRef\n    }, provided.draggableProps, provided.dragHandleProps, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(Card, {\n      className: clsx(classes.card, 'w-full mb-16 rounded-4 cursor-pointer border-1'),\n      elevation: snapshot.isDragging ? 3 : 0,\n      onClick: function onClick(ev) {\n        return handleCardClick(ev, card, list);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 6\n      }\n    }, board.settings.cardCoverImages && card.idAttachmentCover !== '' && /*#__PURE__*/React.createElement(\"img\", {\n      className: \"block\",\n      src: _.find(card.attachments, {\n        id: card.idAttachmentCover\n      }).src,\n      alt: \"card cover\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 8\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"p-16 pb-0\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 7\n      }\n    }, card.idLabels.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex flex-wrap mb-8 -mx-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }\n    }, card.idLabels.map(function (id) {\n      console.log(id);\n\n      var label = _.find(board.labels, {\n        id: id\n      });\n\n      return /*#__PURE__*/React.createElement(Tooltip, {\n        title: label.name,\n        key: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 12\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: clsx(label.class, 'w-32  h-6 rounded-6 mx-4 mb-6'),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }\n      }));\n    })), /*#__PURE__*/React.createElement(Typography, {\n      className: \"font-600 mb-12\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 8\n      }\n    }, card.name), (card.due || checkItems > 0) && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex items-center mb-12 -mx-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }\n    }, card.due && /*#__PURE__*/React.createElement(\"div\", {\n      className: clsx('flex items-center px-8 py-4 mx-4 rounded-sm', moment() > moment(card.due) ? 'bg-red text-white' : 'bg-green text-white'),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-16\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 12\n      }\n    }, \"access_time\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mx-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 12\n      }\n    }, moment(card.due).format('MMM Do YY'))), checkItems > 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: clsx('flex items-center px-8 py-4 mx-4 rounded-sm', checkItemsChecked === checkItems ? 'bg-green text-white' : 'bg-grey-700 text-white'),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-16\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 12\n      }\n    }, \"check_circle\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mx-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 12\n      }\n    }, \"\".concat(checkItemsChecked, \"/\").concat(checkItems)))), card.idMembers.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex flex-wrap mb-12 -mx-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }\n    }, card.idMembers.map(function (id) {\n      var member = _.find(board.members, {\n        id: id\n      });\n\n      return /*#__PURE__*/React.createElement(Tooltip, {\n        title: member.name,\n        key: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 12\n        }\n      }, /*#__PURE__*/React.createElement(Avatar, {\n        className: \"mx-4 w-32 h-32\",\n        src: member.avatar,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }));\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 10\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex justify-between h-48 px-16 border-t-1\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex items-center -mx-6\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 8\n      }\n    }, card.subscribed && /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-18 mx-6\",\n      color: \"action\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 10\n      }\n    }, \"remove_red_eye\"), card.description !== '' && /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-18 mx-6\",\n      color: \"action\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 10\n      }\n    }, \"description\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex items-center justify-end -mx-6\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 8\n      }\n    }, card.attachments && /*#__PURE__*/React.createElement(\"span\", {\n      className: \"flex items-center mx-6\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-18\",\n      color: \"action\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }\n    }, \"attachment\"), /*#__PURE__*/React.createElement(Typography, {\n      className: \"mx-8\",\n      color: \"secondary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 11\n      }\n    }, card.attachments.length)), commentsCount > 0 && /*#__PURE__*/React.createElement(\"span\", {\n      className: \"flex items-center mx-6\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-18\",\n      color: \"action\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 11\n      }\n    }, \"comment\"), /*#__PURE__*/React.createElement(Typography, {\n      className: \"mx-8\",\n      color: \"secondary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }\n    }, commentsCount))))));\n  });\n}\n\nexport default BoardCard;","map":{"version":3,"sources":["/Users/msumaran/Documents/Proyectos/masternativos/src/app/scrumboard/board/BoardCard.js"],"names":["_","Avatar","Card","Icon","makeStyles","Tooltip","Typography","clsx","moment","React","Draggable","useDispatch","useSelector","Actions","useStyles","theme","card","color","transitionProperty","transitionDuration","transitions","duration","short","transitionTimingFunction","easing","easeInOut","BoardCard","props","dispatch","board","scrumboardApp","classes","index","list","checklists","keyBy","values","has","idLabels","checkItems","idMembers","attachments","comments","activities","map","undefined","checkItemsChecked","getCheckItemsChecked","getCheckItems","commentsCount","getCommentsCount","handleCardClick","ev","_card","_list","preventDefault","data","openCardDialog","sum","x","checked","length","type","console","log","id","provided","snapshot","innerRef","draggableProps","dragHandleProps","isDragging","settings","cardCoverImages","idAttachmentCover","find","src","label","labels","name","class","due","format","member","members","avatar","subscribed","description"],"mappings":"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","sourcesContent":["import _ from '@lodash';\nimport Avatar from '@material-ui/core/Avatar';\nimport Card from '@material-ui/core/Card';\nimport Icon from '@material-ui/core/Icon';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport clsx from 'clsx';\nimport moment from 'moment';\nimport React from 'react';\nimport { Draggable } from 'react-beautiful-dnd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport * as Actions from '../store/actions';\n\nconst useStyles = makeStyles(theme => ({\n\tcard: {\n\t\tcolor: '#fff',\n\t\ttransitionProperty: 'box-shadow',\n\t\ttransitionDuration: theme.transitions.duration.short,\n\t\ttransitionTimingFunction: theme.transitions.easing.easeInOut\n\t}\n}));\n\nfunction BoardCard(props) {\n\tconst dispatch = useDispatch();\n\tconst board = useSelector(({ scrumboardApp }) => scrumboardApp.board);\n\t\n\tconst classes = useStyles(props);\n\tconst { card, index, list } = props;\n\n\tcard.checklists = _.keyBy(card.checklists, 'id');\n\tcard.checklists= _.values(card.checklists);\n\tif(!_.has(card, \"idLabels\")) card.idLabels = [];\n\tif(!_.has(card, \"checklists\")) card.checklists = [];\n\tif(!_.has(card, \"checkItems\")) card.checkItems = [];\n\tif(!_.has(card, \"idMembers\")) card.idMembers = [];\n\tif(!_.has(card, \"attachments\")) card.attachments = [];\n\tif(!_.has(card, \"comments\")) card.comments = [];\n\tif(!_.has(card, \"activities\")) card.activities = [];\n\tcard.checklists.map((list) => {\n\n\t\tif(list.checkItems === undefined ) list.checkItems = [];\n\t\treturn null\n\t});\n\n\tconst checkItemsChecked = getCheckItemsChecked(card);\n\tconst checkItems = getCheckItems(card);\n\tconst commentsCount = getCommentsCount(card);\n\n\t\n\n\tfunction handleCardClick(ev, _card,  _list) {\n\t\tev.preventDefault();\n\t\tlet data = {card: _card, list: _list}\n\t\tdispatch(Actions.openCardDialog(data));\n\t}\n\n\tfunction getCheckItemsChecked(_card) {\n\t\tif(!_.has(_card, \"checklists\")) return 0;\n\t\telse return _.sum(_card.checklists.map(list => _.sum(list.checkItems.map(x => (x.checked ? 1 : 0)))));\n\t}\n\n\tfunction getCheckItems(_card) {\n \t\tif(!_.has(_card, \"checklists\")) return 0;\n\t\telse return _.sum(_card.checklists.map(x => x.checkItems.length));\n\t}\n\n\tfunction getCommentsCount(_card) {\n\t\treturn _.sum(_card.activities.map(x => (x.type === 'comment' ? 1 : 0)));\n\t\t//return;\n\t}\n\tconsole.log('card: ',card);\n\n\treturn (\n\t\t<Draggable draggableId={card.id} index={index} type=\"card\">\n\t\t\t{(provided, snapshot) => (\n\t\t\t\t<div ref={provided.innerRef} {...provided.draggableProps} {...provided.dragHandleProps}>\n\t\t\t\t\t<Card\n\t\t\t\t\t\tclassName={clsx(classes.card, 'w-full mb-16 rounded-4 cursor-pointer border-1')}\n\t\t\t\t\t\televation={snapshot.isDragging ? 3 : 0}\n\t\t\t\t\t\tonClick={ev => handleCardClick(ev, card, list)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{board.settings.cardCoverImages && card.idAttachmentCover !== '' && (\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclassName=\"block\"\n\t\t\t\t\t\t\t\tsrc={_.find(card.attachments, { id: card.idAttachmentCover }).src}\n\t\t\t\t\t\t\t\talt=\"card cover\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t<div className=\"p-16 pb-0\">\n\t\t\t\t\t\t\t{card.idLabels.length > 0 && (\n\t\t\t\t\t\t\t\t<div className=\"flex flex-wrap mb-8 -mx-4\">\n\t\t\t\t\t\t\t\t\t{card.idLabels.map(id => {\n\t\t\t\t\t\t\t\t\t\tconsole.log(id);\n\t\t\t\t\t\t\t\t\t\tconst label = _.find(board.labels, { id });\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title={label.name} key={id}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={clsx(label.class, 'w-32  h-6 rounded-6 mx-4 mb-6')} />\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t<Typography className=\"font-600 mb-12\">{card.name}</Typography>\n\n\t\t\t\t\t\t\t{(card.due || checkItems > 0) && (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-12 -mx-4\">\n\t\t\t\t\t\t\t\t\t{card.due && (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center px-8 py-4 mx-4 rounded-sm',\n\t\t\t\t\t\t\t\t\t\t\t\tmoment() > moment(card.due)\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-red text-white'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-green text-white'\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Icon className=\"text-16\">access_time</Icon>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"mx-4\">{moment(card.due).format('MMM Do YY')}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t{checkItems > 0 && (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center px-8 py-4 mx-4 rounded-sm',\n\t\t\t\t\t\t\t\t\t\t\t\tcheckItemsChecked === checkItems\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green text-white'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-grey-700 text-white'\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Icon className=\"text-16\">check_circle</Icon>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"mx-4\">{`${checkItemsChecked}/${checkItems}`}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{card.idMembers.length > 0 && (\n\t\t\t\t\t\t\t\t<div className=\"flex flex-wrap mb-12 -mx-4\">\n\t\t\t\t\t\t\t\t\t{card.idMembers.map(id => {\n\t\t\t\t\t\t\t\t\t\tconst member = _.find(board.members, { id });\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title={member.name} key={id}>\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar className=\"mx-4 w-32 h-32\" src={member.avatar} />\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t<div />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"flex justify-between h-48 px-16 border-t-1\">\n\t\t\t\t\t\t\t<div className=\"flex items-center -mx-6\">\n\t\t\t\t\t\t\t\t{card.subscribed && (\n\t\t\t\t\t\t\t\t\t<Icon className=\"text-18 mx-6\" color=\"action\">\n\t\t\t\t\t\t\t\t\t\tremove_red_eye\n\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{card.description !== '' && (\n\t\t\t\t\t\t\t\t\t<Icon className=\"text-18 mx-6\" color=\"action\">\n\t\t\t\t\t\t\t\t\t\tdescription\n\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-end -mx-6\">\n\t\t\t\t\t\t\t\t{card.attachments && (\n\t\t\t\t\t\t\t\t\t<span className=\"flex items-center mx-6\">\n\t\t\t\t\t\t\t\t\t\t<Icon className=\"text-18\" color=\"action\">\n\t\t\t\t\t\t\t\t\t\t\tattachment\n\t\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t\t\t<Typography className=\"mx-8\" color=\"secondary\">\n\t\t\t\t\t\t\t\t\t\t\t{card.attachments.length}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{commentsCount > 0 && (\n\t\t\t\t\t\t\t\t\t<span className=\"flex items-center mx-6\">\n\t\t\t\t\t\t\t\t\t\t<Icon className=\"text-18\" color=\"action\">\n\t\t\t\t\t\t\t\t\t\t\tcomment\n\t\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t\t\t<Typography className=\"mx-8\" color=\"secondary\">\n\t\t\t\t\t\t\t\t\t\t\t{commentsCount}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Card>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</Draggable>\n\t);\n}\n\nexport default BoardCard;\n"]},"metadata":{},"sourceType":"module"}